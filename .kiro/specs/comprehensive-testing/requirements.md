# 需求规范文档

## 简介

本文档定义了星潮设计资源平台全面功能测试与修复的需求规范。平台是一个专业的数字创意资源交易与分享平台，通过"下载消费-上传创收"的双边市场模式，连接内容消费者与创作者。

测试范围涵盖：
- 前端所有页面、按钮、交互功能
- 后端API接口完整性和正确性
- 数据库表结构和数据完整性
- 前后端数据对接一致性
- 跨浏览器兼容性
- 移动端响应式适配
- 性能指标达标验证

## 术语表

- **平台(Platform)**: 星潮设计资源平台系统
- **用户(User)**: 平台注册用户，包括普通用户、VIP用户、创作者
- **管理员(Admin)**: 后台管理员，包括审核员和超级管理员
- **资源(Resource)**: 数字创意资源，如设计源文件、视频工程、模板、素材等
- **分类(Category)**: 资源分类，支持多级分类树结构
- **VIP系统(VIP_System)**: VIP会员体系，包括套餐、特权、购买流程
- **积分系统(Points_System)**: 积分系统，包括充值、消费、提现功能
- **审核系统(Audit_System)**: 内容审核系统，包括资源审核、评论审核
- **接口(API)**: 后端RESTful接口服务
- **前端(Frontend)**: Vue3 + TypeScript前端应用
- **后端(Backend)**: Express + Prisma后端服务
- **数据库(Database)**: PostgreSQL数据库

## 需求列表

### 需求1：用户认证模块

**用户故事：** 作为用户，我希望能够安全地注册、登录和管理我的账户，以便根据我的角色访问平台功能。

#### 验收标准

1. 当游客访问登录页面时，平台应显示包含手机号和密码输入框的登录表单
2. 当用户提交有效凭证时，平台应验证用户身份并跳转到之前的页面或首页
3. 当用户提交无效凭证时，平台应显示适当的错误信息，但不透露具体是哪个字段错误
4. 当用户点击注册链接时，平台应跳转到注册页面
5. 当游客提交有效的注册表单时，平台应创建新用户账户并发送验证码
6. 当已登录用户请求刷新Token时，平台应返回新的有效访问令牌
7. 当用户点击退出登录时，平台应清除会话并跳转到首页
8. 当未认证用户尝试访问受保护的路由时，平台应跳转到登录页面并保存返回URL
9. 当非管理员用户尝试访问管理员路由时，平台应跳转到首页并显示权限不足提示
10. 如果访问令牌过期，平台应自动尝试刷新令牌，刷新失败后再退出登录

### 需求2：首页展示模块

**用户故事：** 作为用户，我希望看到一个美观且信息丰富的首页，以便快速发现资源并浏览平台。

#### 验收标准

1. 当用户访问首页时，平台应显示一个功能完整的轮播图，支持自动播放和手动切换
2. 当用户点击轮播图时，平台应跳转到配置的链接地址
3. 当首页加载时，平台应显示带有图标和资源数量的分类导航
4. 当用户点击分类时，平台应跳转到按该分类筛选的资源列表
5. 当首页加载时，平台应显示按下载量排序的热门/推荐资源
6. 当用户与搜索框交互时，平台应显示热门搜索关键词
7. 当用户提交搜索查询时，平台应跳转到搜索结果页面
8. 当有活动公告时，平台应显示公告横幅，支持关闭功能
9. 当用户点击公告时，平台应跳转到公告详情或链接
10. 平台应显示响应式布局，适配桌面端、平板和移动端屏幕

### 需求3：资源浏览模块

**用户故事：** 作为用户，我希望能够浏览、搜索和筛选资源，以便找到我需要的创意素材。

#### 验收标准

1. 当用户访问资源列表页时，平台应显示分页的资源列表，包含封面图、标题和元数据
2. 当用户选择分类筛选时，平台应只显示该分类下的资源
3. 当用户选择VIP等级筛选时，平台应只显示符合该VIP要求的资源
4. 当用户选择文件格式筛选时，平台应只显示该格式的资源
5. 当用户更改排序方式时，平台应按选定的条件重新排序资源（最新、下载量、点赞数）
6. 当用户点击资源卡片时，平台应跳转到资源详情页
7. 当用户查看资源详情页时，平台应显示完整的资源信息，包括预览图、描述、作者信息和下载统计
8. 当用户查看资源详情页时，平台应显示相关/相似资源推荐
9. 当用户点击预览图时，平台应显示全屏图片查看器
10. 平台应支持资源列表的无限滚动或分页加载

### 需求4：资源下载模块

**用户故事：** 作为用户，我希望根据我的会员等级下载资源，以便在我的项目中使用这些创意素材。

#### 验收标准

1. 当VIP用户点击下载VIP资源时，平台应直接开始下载，不扣除积分
2. 当非VIP用户点击下载VIP资源时，平台应显示升级VIP的提示
3. 当用户点击下载免费资源时，平台应立即开始下载
4. 当用户点击下载付费资源时，平台应检查积分余额，余额充足则扣除积分
5. 如果用户积分不足以下载付费资源，平台应显示充值积分的提示
6. 当下载开始时，平台应生成安全的、有时效限制的下载链接
7. 当下载完成时，平台应将下载记录保存到用户的下载历史
8. 当用户查看下载历史时，平台应显示所有已下载的资源及时间戳
9. 平台应支持大文件的断点续传下载
10. 平台应防止未授权的直接访问资源文件

### 需求5：收藏功能模块

**用户故事：** 作为用户，我希望能够收藏资源，以便日后方便查找。

#### 验收标准

1. 当已登录用户点击资源的收藏按钮时，平台应将该资源添加到收藏夹
2. 当用户点击已收藏资源的收藏按钮时，平台应取消收藏
3. 当用户查看收藏列表时，平台应显示所有已收藏的资源，支持分页
4. 当用户收藏资源时，平台应更新该资源的收藏数量
5. 当游客点击收藏按钮时，平台应提示先登录
6. 平台应在资源卡片和详情页正确显示收藏状态

### 需求6：资源上传模块

**用户故事：** 作为创作者，我希望能够上传和发布我的创意资源，以便分享和变现我的作品。

#### 验收标准

1. 当已登录用户访问上传页面时，平台应显示多步骤上传表单
2. 当用户选择文件上传时，平台应验证文件格式和大小限制
3. 当用户上传文件时，平台应显示上传进度百分比
4. 当用户填写资源详情时，平台应验证必填字段（标题、分类、描述）
5. 当用户提交上传表单时，平台应创建待审核资源并通知审核
6. 如果文件上传失败，平台应支持重试和断点续传
7. 当用户查看上传历史时，平台应显示所有已上传的资源及审核状态
8. 平台应支持多张预览图和封面图选择
9. 平台应支持设置资源价格（免费、付费、VIP专享）
10. 如果上传被驳回，平台应向创作者显示驳回原因

### 需求7：VIP会员模块

**用户故事：** 作为用户，我希望能够购买VIP会员，以便访问高级资源并享受会员权益。

#### 验收标准

1. 当用户访问VIP页面时，平台应显示可用的VIP套餐及价格和权益
2. 当用户选择VIP套餐时，平台应显示支付方式选项（微信支付、支付宝）
3. 当用户确认购买时，平台应创建订单并跳转到支付
4. 当支付成功时，平台应激活VIP状态并更新到期时间
5. 如果支付失败或取消，平台应显示适当的提示并允许重试
6. 当VIP用户查看个人资料时，平台应显示VIP状态、等级和到期时间
7. 当VIP即将到期时，平台应发送提醒通知
8. 平台应在VIP页面清晰展示VIP特权
9. 当VIP用户下载资源时，平台应应用VIP折扣或免费下载权益
10. 平台应支持VIP续费和升级

### 需求8：积分系统模块

**用户故事：** 作为用户，我希望能够赚取、消费和管理积分，以便下载付费资源并参与平台活动。

#### 验收标准

1. 当用户访问积分页面时，平台应显示当前积分余额和交易历史
2. 当用户完成每日任务时，平台应奖励相应积分
3. 当用户购买积分时，平台应在支付后将积分添加到余额
4. 当用户下载付费资源时，平台应从余额中扣除积分
5. 当创作者的资源被下载时，平台应向创作者账户充入积分（收益分成）
6. 当用户申请提现时，平台应验证最低提现金额并处理申请
7. 平台应显示积分交易历史，包含类型、金额和时间戳
8. 平台应支持积分兑换VIP会员或其他奖励
9. 如果用户积分不足，平台应显示充值选项
10. 平台应防止积分余额变为负数

### 需求9：个人中心模块

**用户故事：** 作为用户，我希望能够管理我的个人资料并查看我的活动，以便跟踪使用情况并更新信息。

#### 验收标准

1. 当用户访问个人中心时，平台应显示用户资料信息（头像、昵称、简介）
2. 当用户点击编辑资料时，平台应允许更新昵称、头像和简介
3. 当用户查看下载标签页时，平台应显示下载历史及资源详情
4. 当用户查看上传标签页时，平台应显示已上传资源及审核状态
5. 当用户查看收藏标签页时，平台应显示已收藏的资源
6. 当用户查看VIP标签页时，平台应显示VIP状态和权益
7. 当用户查看积分标签页时，平台应显示积分余额和交易历史
8. 平台应显示用户统计数据（总下载数、上传数、收藏数）
9. 当用户修改密码时，平台应验证当前密码并安全更新
10. 平台不应在API错误时自动退出登录（仅在认证失败时退出）

### 需求10：后台管理 - 数据概览

**用户故事：** 作为管理员，我希望查看平台统计数据和关键指标，以便监控平台健康状况并做出明智决策。

#### 验收标准

1. 当管理员访问仪表盘时，平台应显示今日新增用户、资源、下载量和收入
2. 当管理员查看仪表盘时，平台应显示关键指标的趋势图表
3. 当管理员查看仪表盘时，平台应显示待审核数量和最近活动
4. 平台应显示与上一周期（日/周/月）的对比数据
5. 平台应定期或按需刷新仪表盘数据
6. 当管理员点击指标卡片时，平台应跳转到详细管理页面

### 需求11：后台管理 - 用户管理

**用户故事：** 作为管理员，我希望管理平台用户，以便维护用户质量并处理违规行为。

#### 验收标准

1. 当管理员访问用户管理时，平台应显示分页的用户列表，支持搜索和筛选
2. 当管理员搜索用户时，平台应按手机号、昵称或用户ID筛选
3. 当管理员查看用户详情时，平台应显示完整的用户信息和活动历史
4. 当管理员禁用用户时，平台应阻止该用户登录并显示禁用状态
5. 当管理员启用已禁用的用户时，平台应恢复登录权限
6. 当管理员调整用户积分时，平台应更新余额并记录操作
7. 当管理员更改用户角色时，平台应相应更新权限
8. 平台应记录所有管理员对用户的操作以供审计
9. 平台应防止管理员禁用自己的账户
10. 平台应支持对多个用户的批量操作

### 需求12：后台管理 - 资源管理

**用户故事：** 作为管理员，我希望管理平台资源，以便维护内容质量和组织结构。

#### 验收标准

1. 当管理员访问资源管理时，平台应显示分页的资源列表，支持筛选
2. 当管理员搜索资源时，平台应按标题、分类、作者或状态筛选
3. 当管理员查看资源详情时，平台应显示完整的资源信息和预览
4. 当管理员编辑资源时，平台应允许更新标题、描述、分类和标签
5. 当管理员删除资源时，平台应软删除并从公开视图中移除
6. 当管理员设置资源为精选时，平台应在推荐区域显示
7. 当管理员设置资源为置顶时，平台应将其固定在列表顶部
8. 平台应显示资源统计数据（下载量、浏览量、收藏量）
9. 平台应支持批量操作（删除、精选、更改分类）
10. 平台应记录所有管理员对资源的操作

### 需求13：后台管理 - 内容审核

**用户故事：** 作为管理员，我希望审核用户提交的资源，以便确保内容质量和合规性。

#### 验收标准

1. 当管理员访问审核页面时，平台应显示按提交时间排序的待审核资源
2. 当管理员审核资源时，平台应显示完整详情，包括预览和文件信息
3. 当管理员通过资源时，平台应将状态改为已通过并公开显示
4. 当管理员驳回资源时，平台应要求填写驳回原因并通知创作者
5. 当管理员查看审核历史时，平台应显示所有已审核的资源及决定
6. 平台应支持按审核状态筛选（待审核、已通过、已驳回）
7. 平台应显示审核统计（待审核数量、今日已审核数量）
8. 平台应防止重复审核已处理的资源（除非明确操作）
9. 平台应支持批量通过多个资源
10. 平台应记录所有审核决定，包含审核员ID和时间戳

### 需求14：后台管理 - 分类管理

**用户故事：** 作为管理员，我希望管理资源分类，以便有效组织内容。

#### 验收标准

1. 当管理员访问分类管理时，平台应显示分类树形结构
2. 当管理员添加分类时，平台应创建包含名称、代码、图标和父级的分类
3. 当管理员编辑分类时，平台应允许更新名称、图标和排序
4. 当管理员删除分类时，平台应先检查是否有子分类和资源
5. 如果分类下有资源，平台应阻止删除或要求重新分配
6. 当管理员重新排序分类时，平台应更新排序并反映到前端
7. 平台应显示每个分类的资源数量
8. 平台应支持设置分类为热门或推荐
9. 平台应验证分类代码的唯一性
10. 平台应支持拖拽重新排序

### 需求15：后台管理 - 轮播图管理

**用户故事：** 作为管理员，我希望管理首页轮播图，以便推广内容和活动。

#### 验收标准

1. 当管理员访问轮播图管理时，平台应显示所有轮播图及预览
2. 当管理员添加轮播图时，平台应允许上传图片并设置链接URL
3. 当管理员编辑轮播图时，平台应允许更新图片、链接和显示时间
4. 当管理员删除轮播图时，平台应立即从显示中移除
5. 当管理员启用/禁用轮播图时，平台应更新前端可见性
6. 当管理员重新排序轮播图时，平台应更新前端显示顺序
7. 平台应支持设置轮播图显示时间段（开始/结束时间）
8. 平台应验证图片尺寸和文件大小
9. 平台应在发布前预览轮播图效果
10. 平台应支持多种链接类型（内部页面、外部URL、资源详情）

### 需求16：后台管理 - 公告管理

**用户故事：** 作为管理员，我希望管理平台公告，以便有效地与用户沟通。

#### 验收标准

1. 当管理员访问公告管理时，平台应显示所有公告
2. 当管理员创建公告时，平台应允许设置标题、内容、类型和链接
3. 当管理员编辑公告时，平台应允许更新所有字段
4. 当管理员删除公告时，平台应从显示中移除
5. 当管理员设置公告为置顶时，平台应将其固定在其他公告之上
6. 当管理员启用/禁用公告时，平台应更新可见性
7. 平台应支持公告类型（普通、重要、紧急）
8. 平台应支持设置显示时间段
9. 平台应支持富文本内容编辑
10. 平台应预览公告效果

### 需求17：后台管理 - 系统设置

**用户故事：** 作为管理员，我希望配置系统设置，以便自定义平台行为。

#### 验收标准

1. 当管理员访问系统设置时，平台应显示分组的配置选项
2. 当管理员更新设置时，平台应保存并立即应用或确认后应用
3. 平台应支持配置网站名称、Logo和联系信息
4. 平台应支持配置积分兑换人民币比例
5. 平台应支持配置平台佣金比例
6. 平台应支持配置最低提现金额
7. 平台应支持配置文件上传限制（大小、格式）
8. 平台应支持配置VIP套餐价格
9. 平台应在保存前验证设置值
10. 平台应记录所有设置更改以供审计

### 需求18：数据库完整性

**用户故事：** 作为开发者，我希望数据库保持数据完整性，以便应用程序正确可靠地运行。

#### 验收标准

1. 数据库应在相关表之间强制执行外键约束
2. 数据库应对所有主键使用UUID格式
3. 数据库应对所有列使用snake_case命名规范
4. 数据库应在所有表上包含created_at和updated_at时间戳
5. 当删除父记录时，数据库应根据定义的级联规则处理子记录
6. 数据库应对手机号、邮箱和代码强制执行唯一约束
7. 数据库应使用适当的数据类型（BigInt用于文件大小，Decimal用于价格）
8. 数据库应对频繁查询的列建立索引以提高性能
9. 数据库应支持PostgreSQL数组类型用于标签和预览图
10. 数据库应在所有关系中保持引用完整性

### 需求19：API接口规范

**用户故事：** 作为开发者，我希望API一致且文档完善，以便前后端集成可靠。

#### 验收标准

1. API应对所有端点使用RESTful规范
2. API应返回一致的响应格式，包含code、message和data字段
3. API应对请求/响应字段名使用camelCase（数据库中使用snake_case）
4. API应返回适当的HTTP状态码（200、201、400、401、403、404、500）
5. API应验证所有输入参数并返回描述性错误信息
6. API应对受保护的端点要求认证令牌
7. API应对敏感端点实现速率限制
8. API应记录所有请求，包含时间戳、方法、路径和响应时间
9. API应优雅地处理错误，不暴露内部细节
10. API应支持分页，包含page、pageSize、total和totalPages

### 需求20：前端UI/UX规范

**用户故事：** 作为用户，我希望有一个一致且响应式的用户界面，以便在任何设备上舒适地使用平台。

#### 验收标准

1. 前端应在整个应用中使用一致的配色方案、字体和间距
2. 前端应为所有异步操作显示加载状态
3. 前端应清晰显示错误信息并提供恢复选项
4. 前端应支持响应式布局：桌面端(>1200px)、平板(768-1200px)和移动端(<768px)
5. 前端应保持一致的按钮样式、大小和悬停状态
6. 前端应一致地使用Element Plus组件
7. 前端应支持键盘导航以提高可访问性
8. 前端应内联显示表单验证错误
9. 前端应在执行破坏性操作前确认
10. 前端应在返回导航时保持滚动位置

### 需求21：性能要求

**用户故事：** 作为用户，我希望页面加载快速、交互响应迅速，以便高效使用平台。

#### 验收标准

1. 平台应在4G网络下3秒内加载首页
2. 平台应在300毫秒内响应用户交互
3. 平台应在200毫秒内加载缩略图
4. 平台应支持渐进式图片加载（从模糊到清晰）
5. 平台应达到Lighthouse性能评分>=90
6. API应在正常负载下500毫秒内响应列表查询
7. 平台应对图片和组件实现懒加载
8. 平台应使用适当的头信息缓存静态资源
9. 平台应通过PWA支持核心页面的离线访问
10. 平台应在1000并发用户下不降级运行

### 需求22：安全要求

**用户故事：** 作为平台所有者，我希望系统安全，以便保护用户数据和资源。

#### 验收标准

1. 平台应使用bcrypt和适当的盐轮数对密码进行哈希
2. 平台应使用具有适当过期时间的JWT令牌进行认证
3. 平台应验证和清理所有用户输入以防止XSS和SQL注入
4. 平台应对状态更改操作实现CSRF保护
5. 平台应对所有通信使用HTTPS
6. 平台应实现速率限制以防止暴力攻击
7. 平台应记录安全相关事件（登录尝试、权限更改）
8. 平台应防止水平权限提升（用户访问其他用户的数据）
9. 平台应防止垂直权限提升（用户访问管理员功能）
10. 平台应为资源生成安全的、有时效限制的下载链接

### 需求23：浏览器兼容性

**用户故事：** 作为用户，我希望能从任何现代浏览器访问平台，以便使用我喜欢的浏览器。

#### 验收标准

1. 平台应在Chrome（最新2个版本）上正常运行
2. 平台应在Edge（最新2个版本）上正常运行
3. 平台应在Safari（最新2个版本）上正常运行
4. 平台应在Firefox（最新2个版本）上正常运行
5. 平台应在移动端Chrome和Safari上正常运行
6. 平台应在微信和支付宝内置浏览器中正常运行
7. 平台应对不支持的浏览器显示优雅降级提示
8. 平台应在支持的浏览器中没有布局问题
9. 平台应适当处理浏览器特定的CSS前缀
10. 平台应测试并修复任何浏览器特定的JavaScript问题

### 需求24：搜索功能模块

**用户故事：** 作为用户，我希望能有效地搜索资源，以便快速找到我需要的内容。

#### 验收标准

1. 当用户输入搜索查询时，平台应在资源标题、描述和标签中搜索
2. 当显示搜索结果时，平台应高亮匹配的关键词
3. 当用户查看搜索结果时，平台应显示结果数量和分页
4. 平台应支持对搜索结果的高级筛选（分类、格式、VIP等级）
5. 平台应在用户输入时显示搜索建议
6. 平台应显示热门搜索关键词以供发现
7. 当没有找到结果时，平台应显示有用的建议
8. 平台应为已登录用户记录搜索历史
9. 平台应支持按相关性、日期或热度排序搜索结果
10. 平台应优雅地处理特殊字符和空查询

### 需求25：错误处理与恢复

**用户故事：** 作为用户，我希望有清晰的错误信息和恢复选项，以便在出现问题时继续使用平台。

#### 验收标准

1. 当发生网络错误时，平台应显示重试选项
2. 当发生404错误时，平台应显示友好的未找到页面，带有导航选项
3. 当发生500错误时，平台应显示通用错误信息，不暴露技术细节
4. 当表单提交失败时，平台应保留用户输入并显示具体错误
5. 当文件上传失败时，平台应允许重试而无需重新选择文件
6. 当会话过期时，平台应提示重新登录并保留当前页面
7. 平台应实现全局错误边界以防止白屏崩溃
8. 平台应记录客户端错误以供调试
9. 当API返回验证错误时，平台应显示字段特定的错误信息
10. 平台应优雅地处理离线状态并显示适当的提示


### 需求26：页面布局与UI美观性

**用户故事：** 作为用户，我希望看到美观、有设计感且布局正确的页面，以便获得良好的视觉体验。

#### 验收标准

1. 平台所有页面布局不能出现错乱，元素位置必须正确
2. 平台应保持现有的UI设计风格，不随意更改已有的美观设计
3. 当发现布局错乱时，平台应修复为正确的布局，同时保持设计美感
4. 当发现展示错误时（如图片不显示、文字溢出、对齐问题），平台应立即修复
5. 平台所有页面在不同屏幕尺寸下都应保持正确的布局
6. 平台的弹窗、模态框、下拉菜单等组件应正确定位，不遮挡重要内容
7. 平台的表格、列表、卡片等组件应正确对齐，间距一致
8. 平台的图标、按钮、输入框等元素应大小适中，视觉协调
9. 平台的颜色、字体、阴影等样式应与整体设计风格一致
10. 如果需要修改UI，应在保持现有设计感的基础上进行优化

### 需求27：未实现功能开发

**用户故事：** 作为用户，我希望所有按钮和功能都能正常工作，以便完整地使用平台。

#### 验收标准

1. 当测试发现某个按钮对应的功能未实现时，平台应优先开发该功能
2. 当发现需要新增功能时，应先更新需求文档，然后进行开发
3. 新开发的功能应与现有功能风格保持一致
4. 新开发的功能完成后，应与相关的现有功能一起进行全面测试
5. 所有页面上的按钮都应有对应的功能实现，不能出现点击无反应的情况
6. 所有导航链接都应正确跳转到目标页面
7. 所有表单提交按钮都应正确处理数据
8. 所有操作按钮（编辑、删除、保存等）都应正确执行对应操作
9. 如果某功能暂时无法实现，应显示"功能开发中"的友好提示
10. 新功能开发完成后，应更新相关文档和测试用例

### 需求28：代码规范与数据库规范

**用户故事：** 作为开发者，我希望代码和数据库遵循统一规范，以便减少bug并提高可维护性。

#### 验收标准

1. 数据库表名必须使用snake_case命名（如user_favorites，不是userFavorites）
2. 数据库字段名必须使用snake_case命名（如created_at，不是createdAt）
3. 前端代码变量和函数必须使用camelCase命名
4. API请求/响应字段必须使用camelCase，后端自动转换为snake_case
5. 所有数据库表必须有主键（使用UUID格式）
6. 所有数据库表必须有created_at和updated_at时间戳字段
7. 外键关系必须正确定义，确保数据完整性
8. 代码必须通过ESLint检查，无语法错误和警告
9. TypeScript代码必须通过类型检查，无any类型滥用
10. 所有API接口必须有统一的响应格式：{ code, message, data }

### 需求29：回归测试与关联功能测试

**用户故事：** 作为测试人员，我希望确保修复bug不会影响其他功能，以便保证系统整体稳定性。

#### 验收标准

1. 当修复一个bug后，必须重新测试该功能的所有相关场景
2. 当修改某个功能时，必须识别所有关联功能并重新测试
3. 如果修改了登录功能，必须重新测试所有需要登录的功能
4. 如果修改了用户模块，必须重新测试个人中心、下载、上传、收藏等功能
5. 如果修改了资源模块，必须重新测试列表、详情、下载、收藏、搜索等功能
6. 如果修改了API接口，必须重新测试所有调用该接口的前端功能
7. 如果修改了数据库表结构，必须重新测试所有涉及该表的功能
8. 如果修改了公共组件，必须重新测试所有使用该组件的页面
9. 如果修改了工具函数或公共方法，必须重新测试所有调用处
10. 每次修复后，必须确保之前已修复的bug没有复现

### 需求30：功能关联映射

**用户故事：** 作为测试人员，我需要清楚了解功能之间的关联关系，以便进行完整的回归测试。

#### 验收标准

1. 认证模块关联：登录→所有需要认证的页面、Token刷新→所有API调用、退出→清除所有用户状态
2. 用户模块关联：用户信息→个人中心、资源上传、评论、收藏；积分→下载、VIP购买
3. 资源模块关联：资源列表→首页、搜索、分类；资源详情→下载、收藏、评论
4. 下载模块关联：下载→积分扣除、下载历史、资源下载量统计
5. 收藏模块关联：收藏→资源收藏数、个人收藏列表
6. VIP模块关联：VIP状态→下载权限、VIP标识显示、特权功能
7. 积分模块关联：积分余额→下载、充值、提现、任务奖励
8. 后台管理关联：用户管理→前台用户状态；资源管理→前台资源显示；审核→资源上架
9. 数据库关联：用户表→资源表、订单表、下载记录表、收藏表
10. API关联：认证API→所有受保护API；用户API→个人中心、资源上传


### 需求31：开发流程规范

**用户故事：** 作为开发者，我希望遵循标准的开发流程，以便确保代码质量和功能完整性。

#### 验收标准

1. 开发新功能前，必须先更新需求文档，明确功能需求和验收标准
2. 开发前必须先检查数据库表结构是否满足需求，不满足则先修改数据库
3. 后端API开发必须先于前端功能开发，确保接口可用
4. 前端开发必须基于已完成的后端API进行，不使用Mock数据
5. 每个功能开发完成后，必须先进行单元测试，再进行集成测试
6. 代码提交前必须通过ESLint检查和TypeScript类型检查
7. 功能开发完成后，必须更新相关文档（API文档、测试用例）
8. 发现bug时，必须先记录bug详情，再进行修复
9. bug修复后，必须进行回归测试，确保不影响其他功能
10. 所有代码变更必须有清晰的提交信息，说明变更内容

### 需求32：测试顺序规范

**用户故事：** 作为测试人员，我希望按照正确的顺序进行测试，以便高效发现和修复问题。

#### 验收标准

1. 测试必须按照以下顺序进行：环境配置→数据库→后端API→前端功能→集成测试→性能测试
2. 环境配置测试：确保数据库连接、环境变量、依赖包都正确配置
3. 数据库测试：验证表结构、外键关系、测试数据是否正确
4. 后端API测试：验证每个接口的请求/响应是否符合规范
5. 前端功能测试：验证每个页面、按钮、表单的功能是否正常
6. 集成测试：验证前后端数据交互是否正确
7. 性能测试：验证页面加载时间、API响应时间是否达标
8. 跨浏览器测试：验证在不同浏览器中功能是否正常
9. 移动端测试：验证响应式布局和触摸交互是否正常
10. 安全测试：验证认证、授权、输入验证是否安全

### 需求33：多场景测试覆盖

**用户故事：** 作为测试人员，我希望覆盖所有可能的使用场景，以便发现潜在问题。

#### 验收标准

1. 正常场景测试：验证功能在正常输入和操作下是否正常工作
2. 边界场景测试：验证功能在边界值（最大、最小、空值）下的表现
3. 异常场景测试：验证功能在异常输入（特殊字符、超长文本、非法格式）下的处理
4. 并发场景测试：验证多用户同时操作时的数据一致性
5. 网络异常测试：验证网络断开、超时、重连时的处理
6. 权限场景测试：验证不同角色（游客、普通用户、VIP、管理员）的权限控制
7. 状态切换测试：验证用户状态变化（登录/退出、VIP开通/过期）后的功能表现
8. 数据状态测试：验证资源状态变化（待审核、已通过、已下架）后的显示和操作
9. 支付场景测试：验证支付成功、失败、取消、超时等各种情况的处理
10. 文件操作测试：验证上传、下载在各种文件类型、大小下的表现

### 需求34：测试优先级规范

**用户故事：** 作为测试人员，我希望按照优先级进行测试，以便优先保证核心功能的稳定性。

#### 验收标准

1. P0（致命）：系统无法启动、核心功能完全不可用、数据丢失风险
2. P1（严重）：核心功能异常、支付流程问题、用户无法登录
3. P2（一般）：非核心功能异常、UI显示问题、性能问题
4. P3（轻微）：文案错误、样式微调、优化建议
5. 测试顺序：先测试P0级功能，再测试P1级，依次进行
6. 核心功能优先：登录注册→资源浏览→资源下载→VIP购买→后台管理
7. 发现P0/P1级bug时，必须立即修复，不继续测试其他功能
8. 发现P2/P3级bug时，可以记录后继续测试，批量修复
9. 每个模块测试完成后，必须确保该模块所有P0/P1级bug已修复
10. 全部测试完成后，必须进行一次完整的回归测试

### 需求35：测试环境与数据管理

**用户故事：** 作为测试人员，我希望有完整的测试环境和数据，以便进行全面的测试。

#### 验收标准

1. 测试环境必须与生产环境配置一致，包括数据库、缓存、文件存储
2. 测试数据必须覆盖所有用户角色：游客、普通用户、VIP用户、创作者、审核员、管理员
3. 测试数据必须覆盖所有资源状态：待审核、已通过、已驳回、已下架
4. 测试数据必须覆盖所有价格类型：免费、付费、VIP专享
5. 测试数据必须覆盖所有文件格式：PSD、AI、ZIP、MP4等
6. 测试账号必须有明确的用途说明，不混用
7. 测试数据必须可以快速重置，便于重复测试
8. 测试过程中产生的数据必须在测试完成后清理
9. 敏感数据（支付、密码）必须使用测试/沙箱环境
10. 测试环境必须与开发环境隔离，避免相互影响


### 需求36：前后端接口对接规范

**用户故事：** 作为开发者，我希望前后端接口对接遵循统一规范，以便确保数据传输正确无误。

#### 验收标准

1. 所有API接口必须使用统一的基础URL：/api/v1/
2. 请求方法规范：GET（查询）、POST（创建）、PUT（更新）、DELETE（删除）
3. 请求头必须包含：Content-Type: application/json、Authorization: Bearer {token}
4. 响应格式必须统一：{ code: number, message: string, data: any }
5. 成功响应code为0或200，失败响应code为对应的错误码
6. 分页接口必须返回：{ list: [], total: number, page: number, pageSize: number, totalPages: number }
7. 时间字段统一使用ISO 8601格式：2025-12-22T10:30:00.000Z
8. 金额字段统一使用字符串格式，保留2位小数："99.00"
9. 布尔值统一使用true/false，不使用0/1
10. 空值统一使用null，不使用undefined或空字符串

### 需求37：接口字段命名规范

**用户故事：** 作为开发者，我希望接口字段命名统一，以便前后端对接不出现字段不匹配的问题。

#### 验收标准

1. 前端请求参数使用camelCase：userId、resourceId、pageSize
2. 后端数据库字段使用snake_case：user_id、resource_id、page_size
3. 后端必须实现字段自动转换中间件，请求时camelCase→snake_case，响应时snake_case→camelCase
4. 主键字段命名规范：userId、resourceId、categoryId（不是id）
5. 时间字段命名规范：createdAt、updatedAt、deletedAt
6. 状态字段命名规范：status（数字）、isActive（布尔）
7. 数量字段命名规范：downloadCount、viewCount、likeCount
8. 列表字段命名规范：list、items（不是data或records）
9. 分页字段命名规范：page、pageSize、total、totalPages
10. 前后端字段名必须完全一致，不能出现前端用userId后端返回user_id的情况

### 需求38：接口错误码规范

**用户故事：** 作为开发者，我希望接口错误码统一，以便前端正确处理各种错误情况。

#### 验收标准

1. 200：请求成功
2. 201：创建成功
3. 400：请求参数错误（缺少必填参数、参数格式错误）
4. 401：未认证（Token无效或过期）
5. 403：无权限（用户无权访问该资源）
6. 404：资源不存在
7. 409：资源冲突（如手机号已注册）
8. 422：业务逻辑错误（如积分不足）
9. 429：请求过于频繁（触发限流）
10. 500：服务器内部错误

### 需求39：接口安全规范

**用户故事：** 作为开发者，我希望接口安全可靠，以便保护用户数据和系统安全。

#### 验收标准

1. 所有接口必须使用HTTPS协议
2. 敏感接口（登录、支付）必须实现速率限制
3. 用户密码必须使用bcrypt加密，不能明文传输或存储
4. JWT Token必须设置合理的过期时间（access_token: 2小时，refresh_token: 7天）
5. 接口必须验证用户权限，防止越权访问
6. 接口必须验证数据所有权，用户只能操作自己的数据
7. 文件上传接口必须验证文件类型和大小
8. 下载链接必须是临时的、有时效的、防盗链的
9. 敏感操作（删除、支付）必须二次确认
10. 所有接口必须记录访问日志，便于审计和排查问题

### 需求40：接口性能规范

**用户故事：** 作为用户，我希望接口响应快速，以便获得流畅的使用体验。

#### 验收标准

1. 普通查询接口响应时间必须小于200ms
2. 列表查询接口响应时间必须小于500ms
3. 文件上传接口必须支持分片上传和断点续传
4. 大文件下载接口必须支持断点续传
5. 接口必须实现合理的缓存策略
6. 数据库查询必须使用索引，避免全表扫描
7. 接口必须实现分页，单次返回数据不超过100条
8. 图片资源必须支持CDN加速
9. 接口必须能承受1000并发请求
10. 接口超时时间设置为30秒，超时后返回友好提示

### 需求41：上线前检查清单

**用户故事：** 作为项目负责人，我希望上线前完成所有检查，以便确保系统稳定可靠。

#### 验收标准

1. 所有P0/P1级bug已修复并通过回归测试
2. 所有核心功能已测试通过（登录、浏览、下载、支付、后台管理）
3. 所有API接口已测试通过，响应格式正确
4. 数据库表结构完整，外键关系正确
5. 环境变量已正确配置（数据库、支付、第三方登录）
6. HTTPS证书已配置并生效
7. 静态资源已压缩并配置CDN
8. 日志系统已配置并正常记录
9. 备份策略已配置（数据库、文件）
10. 监控告警已配置（服务器、数据库、API）

### 需求42：测试数据清理规范

**用户故事：** 作为项目负责人，我希望上线前清理所有测试数据，以便确保生产环境数据干净。

#### 验收标准

1. 删除所有测试用户账号（手机号以138、139开头的测试账号）
2. 删除所有测试资源数据（ID以test-、res-开头的资源）
3. 删除所有测试订单数据
4. 删除所有测试下载记录
5. 删除所有测试收藏记录
6. 删除所有测试积分记录
7. 保留必要的初始化数据（分类、角色、权限、系统配置）
8. 保留管理员账号（但需修改为正式密码）
9. 清理测试上传的文件
10. 验证清理后系统功能正常


### 需求43：接口规范并行检查

**用户故事：** 作为开发者，我希望在测试每个功能时同步检查接口规范，以便及时发现和修复接口问题。

#### 验收标准

1. 测试每个功能时，必须同时检查该功能涉及的所有API接口
2. 检查接口URL是否符合RESTful规范（/api/v1/resources、/api/v1/users等）
3. 检查请求参数命名是否为camelCase
4. 检查响应数据命名是否为camelCase（后端已转换）
5. 检查响应格式是否为{ code, message, data }
6. 检查错误响应是否返回正确的HTTP状态码和错误信息
7. 检查分页接口是否返回完整的分页信息
8. 检查时间字段格式是否正确
9. 检查接口响应时间是否在规定范围内
10. 发现接口不规范时，必须立即修复，不能遗留到最后

### 需求44：功能测试与接口测试同步执行

**用户故事：** 作为测试人员，我希望功能测试和接口测试同步进行，以便全面验证功能正确性。

#### 验收标准

1. 测试登录功能时，同步测试/api/v1/auth/login接口的请求/响应格式
2. 测试资源列表时，同步测试/api/v1/resources接口的分页、筛选、排序参数
3. 测试资源详情时，同步测试/api/v1/resources/:id接口的返回字段完整性
4. 测试下载功能时，同步测试下载接口的权限验证和积分扣除逻辑
5. 测试收藏功能时，同步测试收藏接口的添加/取消/查询功能
6. 测试上传功能时，同步测试上传接口的文件验证和进度返回
7. 测试VIP购买时，同步测试订单创建和支付回调接口
8. 测试后台管理时，同步测试所有管理接口的权限验证
9. 每个接口测试必须包含：正常请求、参数错误、权限不足、资源不存在等场景
10. 接口测试结果必须记录在测试报告中，与功能测试结果一起汇报

### 需求45：接口文档同步更新

**用户故事：** 作为开发者，我希望接口文档与实际接口保持同步，以便前后端对接准确无误。

#### 验收标准

1. 每个接口必须有对应的文档说明
2. 文档必须包含：接口URL、请求方法、请求参数、响应格式、错误码
3. 修改接口时，必须同步更新文档
4. 新增接口时，必须先编写文档，再进行开发
5. 文档中的示例数据必须与实际接口返回一致
6. 文档必须说明接口的权限要求（公开/需登录/需管理员）
7. 文档必须说明接口的限流规则（如有）
8. 前端开发必须参照接口文档进行对接
9. 测试时必须对照文档验证接口行为
10. 发现文档与实际不符时，必须立即更新文档或修复接口

### 需求46：数据一致性检查

**用户故事：** 作为测试人员，我希望验证前后端数据一致性，以便确保用户看到的数据是正确的。

#### 验收标准

1. 前端显示的数据必须与后端接口返回的数据完全一致
2. 前端显示的数量（下载量、收藏量等）必须与数据库中的数据一致
3. 前端显示的状态（VIP状态、审核状态等）必须与数据库中的状态一致
4. 前端显示的时间必须正确格式化，与后端返回的时间一致
5. 前端显示的金额必须与后端返回的金额一致，保留正确的小数位
6. 列表数据的排序必须与后端返回的顺序一致
7. 分页信息（总数、当前页、总页数）必须与后端返回一致
8. 用户操作后（收藏、下载等），前端显示必须立即更新
9. 多个页面显示同一数据时，必须保持一致
10. 发现数据不一致时，必须定位是前端问题还是后端问题，并立即修复

### 需求47：实时测试与修复流程

**用户故事：** 作为测试人员，我希望发现问题后立即修复，以便保证测试效率和质量。

#### 验收标准

1. 测试过程中发现的问题必须立即记录，包含问题描述、复现步骤、截图
2. P0/P1级问题必须立即修复，修复后立即回归测试
3. P2/P3级问题可以记录后继续测试，但必须在当天内修复
4. 修复问题后，必须测试该功能的所有场景，确保修复完整
5. 修复问题后，必须测试所有关联功能，确保没有引入新问题
6. 每个问题修复后，必须更新测试报告，标记为已修复
7. 同一问题如果多次出现，必须分析根本原因，彻底解决
8. 测试和修复必须形成闭环：发现→记录→修复→验证→关闭
9. 每天结束时，必须汇总当天发现和修复的问题
10. 所有问题必须在上线前全部解决，不能遗留任何已知问题


### 需求48：沟通语言规范

**用户故事：** 作为项目负责人，我希望所有开发和测试的沟通都使用中文，以便我能够完全理解每个细节。

#### 验收标准

1. 所有测试报告必须使用中文编写
2. 所有bug描述必须使用中文
3. 所有代码注释建议使用中文（关键业务逻辑）
4. 所有文档必须使用中文
5. 所有沟通回复必须使用中文
6. 变量名和函数名可以使用英文，但注释必须用中文说明
7. 错误提示信息面向用户的部分必须使用中文
8. 日志信息可以使用英文，但关键业务日志建议中文
9. 数据库字段名使用英文，但字段说明使用中文
10. 不管在任何对话窗口或任何时候，开发细节的回复都必须使用中文
