# è½®æ’­å›¾ç‚¹å‡»æ¶ˆå¤±é—®é¢˜ - æ ¹æœ¬åŸå› ä¿®å¤

**ä¿®å¤æ—¥æœŸï¼š** 2025-12-22  
**é—®é¢˜çº§åˆ«ï¼š** ä¸¥é‡ ğŸ”´  
**ä¿®å¤çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  

## ğŸ› é—®é¢˜å¤ç°

ç”¨æˆ·æŠ¥å‘Šï¼šç‚¹å‡»è½®æ’­å›¾åï¼Œè½®æ’­å›¾ç›´æ¥æ¶ˆå¤±äº†ã€‚è¿™ä¸ªé—®é¢˜åœ¨æ˜¨å¤©ä¿®å¤ååˆå¤ç°äº†ã€‚

## ğŸ” æ ¹æœ¬åŸå› åˆ†æ

### æ˜¨å¤©çš„ä¿®å¤ï¼ˆ2024-12-21ï¼‰

æ˜¨å¤©çš„ä¿®å¤æ·»åŠ äº†è·³è½¬é€»è¾‘ï¼Œä½†**å¼•å…¥äº†æ–°çš„é—®é¢˜**ï¼š

```vue
<!-- Home/index.vue -->
<BannerCarousel
  @change="handleBannerChange"
  @click="handleBannerClick"  <!-- âŒ ç›‘å¬äº†clickäº‹ä»¶ -->
/>
```

```typescript
// Home/index.vue
function handleBannerClick(banner: BannerInfo): void {
  // å¤„ç†è·³è½¬é€»è¾‘
  router.push(...);  // âŒ ç¬¬ä¸€æ¬¡è·³è½¬
}
```

```typescript
// BannerCarousel.vue
function handleBannerClick(banner: BannerInfo): void {
  emit('click', banner);  // è§¦å‘çˆ¶ç»„ä»¶çš„å¤„ç†
  router.push(...);       // âŒ ç¬¬äºŒæ¬¡è·³è½¬
}
```

### é—®é¢˜æœ¬è´¨ï¼šåŒé‡è·³è½¬

1. **ç¬¬ä¸€æ¬¡è·³è½¬**ï¼š`BannerCarousel.vue` ç»„ä»¶å†…éƒ¨æ‰§è¡Œ `router.push()`
2. **ç¬¬äºŒæ¬¡è·³è½¬**ï¼šè§¦å‘ `emit('click')` åï¼Œçˆ¶ç»„ä»¶ `Home/index.vue` å†æ¬¡æ‰§è¡Œ `router.push()`
3. **ç»“æœ**ï¼šä¸¤æ¬¡å¿«é€Ÿè·³è½¬å¯¼è‡´ç»„ä»¶çŠ¶æ€å¼‚å¸¸ï¼Œè½®æ’­å›¾æ¶ˆå¤±

### ä¸ºä»€ä¹ˆä¼šæ¶ˆå¤±ï¼Ÿ

```
ç‚¹å‡»è½®æ’­å›¾
  â†“
BannerCarouselå†…éƒ¨è·³è½¬ (ç¬¬1æ¬¡)
  â†“
emit('click', banner)
  â†“
Homeç»„ä»¶å†æ¬¡è·³è½¬ (ç¬¬2æ¬¡)
  â†“
è·¯ç”±å¿«é€Ÿåˆ‡æ¢2æ¬¡
  â†“
ç»„ä»¶å¸è½½/é‡æ–°æŒ‚è½½å¼‚å¸¸
  â†“
è½®æ’­å›¾æ¶ˆå¤± âŒ
```

## ğŸ”§ æ ¹æœ¬è§£å†³æ–¹æ¡ˆ

### åŸåˆ™ï¼šå•ä¸€èŒè´£

**è½®æ’­å›¾ç»„ä»¶åº”è¯¥è‡ªå·±å¤„ç†ç‚¹å‡»äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶ä¸åº”è¯¥å¹²é¢„ã€‚**

### ä¿®å¤æ­¥éª¤

#### 1. ç§»é™¤çˆ¶ç»„ä»¶çš„ç‚¹å‡»ç›‘å¬

```vue
<!-- Home/index.vue - ä¿®å¤å‰ -->
<BannerCarousel
  @change="handleBannerChange"
  @click="handleBannerClick"  <!-- âŒ ç§»é™¤è¿™ä¸ª -->
/>

<!-- Home/index.vue - ä¿®å¤å -->
<BannerCarousel
  @change="handleBannerChange"  <!-- âœ… åªç›‘å¬changeäº‹ä»¶ -->
/>
```

#### 2. åˆ é™¤çˆ¶ç»„ä»¶çš„é‡å¤å¤„ç†å‡½æ•°

```typescript
// Home/index.vue - åˆ é™¤è¿™ä¸ªå‡½æ•°
function handleBannerClick(banner: BannerInfo): void {
  // âŒ åˆ é™¤æ•´ä¸ªå‡½æ•°
}
```

#### 3. ä¿ç•™ç»„ä»¶å†…éƒ¨çš„å®Œæ•´é€»è¾‘

```typescript
// BannerCarousel.vue - ä¿æŒä¸å˜
function handleBannerClick(banner: BannerInfo): void {
  emit('click', banner);  // âœ… ä»ç„¶emitäº‹ä»¶ï¼ˆç”¨äºç»Ÿè®¡ç­‰ï¼‰

  // âœ… ç»„ä»¶å†…éƒ¨å¤„ç†è·³è½¬
  switch (banner.linkType) {
    case 'internal':
      router.push(banner.linkUrl);
      break;
    case 'external':
      window.open(banner.linkUrl, '_blank');
      break;
    case 'category':
      router.push(`/resource?category=${banner.linkUrl}`);
      break;
    case 'resource':
      router.push(`/resource/${banner.linkUrl}`);
      break;
  }
}
```

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### src/views/Home/index.vue

**ä¿®æ”¹å†…å®¹ï¼š**
1. ç§»é™¤ `@click="handleBannerClick"` äº‹ä»¶ç›‘å¬
2. åˆ é™¤ `handleBannerClick` å‡½æ•°å®šä¹‰

**ä¿®æ”¹å‰ï¼š**
```vue
<BannerCarousel
  height="400px"
  mobile-height="200px"
  @change="handleBannerChange"
  @click="handleBannerClick"
/>
```

**ä¿®æ”¹åï¼š**
```vue
<BannerCarousel
  height="400px"
  mobile-height="200px"
  @change="handleBannerChange"
/>
```

## âœ… éªŒè¯æµ‹è¯•

### æµ‹è¯•æ­¥éª¤

1. å¯åŠ¨é¡¹ç›®ï¼š`npm run dev`
2. è®¿é—®é¦–é¡µï¼šhttp://localhost:3000
3. ç‚¹å‡»ä»»æ„è½®æ’­å›¾
4. éªŒè¯ï¼š
   - âœ… è½®æ’­å›¾ä¸æ¶ˆå¤±
   - âœ… æ­£ç¡®è·³è½¬åˆ°ç›®æ ‡é¡µé¢
   - âœ… æ— é”™è¯¯æç¤º
   - âœ… æ§åˆ¶å°æ— é”™è¯¯

### æµ‹è¯•ç»“æœ

| æµ‹è¯•é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| ç‚¹å‡»ä¸æ¶ˆå¤± | âœ… | è½®æ’­å›¾ä¿æŒæ˜¾ç¤º |
| æ­£ç¡®è·³è½¬ | âœ… | è·³è½¬åˆ°æ­£ç¡®é¡µé¢ |
| æ— åŒé‡è·³è½¬ | âœ… | åªè·³è½¬ä¸€æ¬¡ |
| æ§åˆ¶å°æ— é”™è¯¯ | âœ… | æ— ä»»ä½•é”™è¯¯ |
| è¿”å›é¦–é¡µæ­£å¸¸ | âœ… | è½®æ’­å›¾æ­£å¸¸æ˜¾ç¤º |

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. å•ä¸€èŒè´£åŸåˆ™

**ç»„ä»¶åº”è¯¥è‡ªå·±å¤„ç†è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚**

- âœ… è½®æ’­å›¾ç»„ä»¶å¤„ç†ç‚¹å‡»è·³è½¬
- âœ… çˆ¶ç»„ä»¶åªç›‘å¬éœ€è¦çš„äº‹ä»¶ï¼ˆå¦‚changeï¼‰
- âŒ çˆ¶ç»„ä»¶ä¸åº”è¯¥é‡å¤å¤„ç†å­ç»„ä»¶å·²ç»å¤„ç†çš„é€»è¾‘

### 2. äº‹ä»¶è®¾è®¡åŸåˆ™

**emitäº‹ä»¶çš„ç›®çš„ï¼š**
- âœ… é€šçŸ¥çˆ¶ç»„ä»¶å‘ç”Ÿäº†ä»€ä¹ˆï¼ˆç”¨äºç»Ÿè®¡ã€æ—¥å¿—ç­‰ï¼‰
- âŒ ä¸æ˜¯è®©çˆ¶ç»„ä»¶é‡æ–°å¤„ç†ä¸šåŠ¡é€»è¾‘

**æ­£ç¡®çš„äº‹ä»¶ä½¿ç”¨ï¼š**
```typescript
// å­ç»„ä»¶
emit('click', banner);  // é€šçŸ¥çˆ¶ç»„ä»¶"æˆ‘è¢«ç‚¹å‡»äº†"
router.push(...);       // è‡ªå·±å¤„ç†è·³è½¬

// çˆ¶ç»„ä»¶ï¼ˆå¯é€‰ï¼‰
function handleBannerClick(banner) {
  // åªåšç»Ÿè®¡ã€åŸ‹ç‚¹ç­‰
  trackEvent('banner_click', banner);
  // âŒ ä¸è¦å†æ¬¡è·³è½¬ï¼
}
```

### 3. é¿å…é‡å¤å¤„ç†

**é—®é¢˜æ¨¡å¼ï¼š**
```
å­ç»„ä»¶å¤„ç† â†’ emitäº‹ä»¶ â†’ çˆ¶ç»„ä»¶å†æ¬¡å¤„ç† âŒ
```

**æ­£ç¡®æ¨¡å¼ï¼š**
```
å­ç»„ä»¶å¤„ç† â†’ emitäº‹ä»¶ â†’ çˆ¶ç»„ä»¶è®°å½•/ç»Ÿè®¡ âœ…
```

## ğŸ“Š å¯¹æ¯”åˆ†æ

### ä¿®å¤å‰ï¼ˆåŒé‡å¤„ç†ï¼‰

```
ç”¨æˆ·ç‚¹å‡»
  â†“
BannerCarousel.handleBannerClick()
  â”œâ”€ router.push() [ç¬¬1æ¬¡è·³è½¬]
  â””â”€ emit('click')
       â†“
     Home.handleBannerClick()
       â””â”€ router.push() [ç¬¬2æ¬¡è·³è½¬] âŒ
```

**é—®é¢˜ï¼š** ä¸¤æ¬¡è·³è½¬å¯¼è‡´ç»„ä»¶çŠ¶æ€å¼‚å¸¸

### ä¿®å¤åï¼ˆå•ä¸€å¤„ç†ï¼‰

```
ç”¨æˆ·ç‚¹å‡»
  â†“
BannerCarousel.handleBannerClick()
  â”œâ”€ router.push() [å”¯ä¸€è·³è½¬] âœ…
  â””â”€ emit('click') [ä»…ç”¨äºé€šçŸ¥]
```

**ä¼˜åŠ¿ï¼š** æ¸…æ™°ã€å¯é ã€æ— å‰¯ä½œç”¨

## ğŸš€ åç»­å»ºè®®

### 1. ä»£ç å®¡æŸ¥æ¸…å•

åœ¨æ·»åŠ äº‹ä»¶ç›‘å¬æ—¶ï¼Œæ£€æŸ¥ï¼š
- [ ] å­ç»„ä»¶æ˜¯å¦å·²ç»å¤„ç†äº†è¿™ä¸ªäº‹ä»¶ï¼Ÿ
- [ ] çˆ¶ç»„ä»¶æ˜¯å¦çœŸçš„éœ€è¦ç›‘å¬ï¼Ÿ
- [ ] ç›‘å¬çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç»Ÿè®¡ï¼Ÿè¿˜æ˜¯ä¸šåŠ¡é€»è¾‘ï¼Ÿï¼‰
- [ ] æ˜¯å¦ä¼šå¯¼è‡´é‡å¤å¤„ç†ï¼Ÿ

### 2. ç»„ä»¶è®¾è®¡è§„èŒƒ

**å­ç»„ä»¶èŒè´£ï¼š**
- âœ… å¤„ç†è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘
- âœ… emitäº‹ä»¶é€šçŸ¥çˆ¶ç»„ä»¶
- âœ… æä¾›å¿…è¦çš„propsé…ç½®

**çˆ¶ç»„ä»¶èŒè´£ï¼š**
- âœ… ä¼ é€’é…ç½®props
- âœ… ç›‘å¬äº‹ä»¶åšç»Ÿè®¡/æ—¥å¿—
- âŒ ä¸è¦é‡å¤å¤„ç†å­ç»„ä»¶çš„ä¸šåŠ¡é€»è¾‘

### 3. æµ‹è¯•å»ºè®®

**å•å…ƒæµ‹è¯•ï¼š**
```typescript
// BannerCarousel.test.ts
it('ç‚¹å‡»è½®æ’­å›¾åº”è¯¥è·³è½¬', async () => {
  const wrapper = mount(BannerCarousel);
  await wrapper.find('.banner-item').trigger('click');
  
  // éªŒè¯åªè·³è½¬ä¸€æ¬¡
  expect(mockRouter.push).toHaveBeenCalledTimes(1);
});
```

**é›†æˆæµ‹è¯•ï¼š**
```typescript
// Home.test.ts
it('ç‚¹å‡»è½®æ’­å›¾ä¸åº”è¯¥æ¶ˆå¤±', async () => {
  const wrapper = mount(Home);
  const banner = wrapper.findComponent(BannerCarousel);
  
  await banner.find('.banner-item').trigger('click');
  await nextTick();
  
  // éªŒè¯è½®æ’­å›¾ä»ç„¶å­˜åœ¨
  expect(wrapper.findComponent(BannerCarousel).exists()).toBe(true);
});
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ˜¨å¤©çš„ä¿®å¤æŠ¥å‘Š](../archive/docs/fixes/è½®æ’­å›¾ç‚¹å‡»è·³è½¬ä¿®å¤æŠ¥å‘Š.md)
- [BannerCarouselç»„ä»¶](../src/components/business/BannerCarousel.vue)
- [Homeé¡µé¢](../src/views/Home/index.vue)

## âœ¨ æ€»ç»“

### é—®é¢˜æ ¹æº

**åŒé‡è·³è½¬å¯¼è‡´ç»„ä»¶çŠ¶æ€å¼‚å¸¸**
- å­ç»„ä»¶è·³è½¬ä¸€æ¬¡
- çˆ¶ç»„ä»¶åˆè·³è½¬ä¸€æ¬¡
- å¿«é€Ÿçš„ä¸¤æ¬¡è·¯ç”±åˆ‡æ¢å¯¼è‡´è½®æ’­å›¾æ¶ˆå¤±

### è§£å†³æ–¹æ¡ˆ

**ç§»é™¤çˆ¶ç»„ä»¶çš„é‡å¤å¤„ç†**
- åªè®©å­ç»„ä»¶å¤„ç†è·³è½¬
- çˆ¶ç»„ä»¶ä¸ç›‘å¬clickäº‹ä»¶
- éµå¾ªå•ä¸€èŒè´£åŸåˆ™

### ç»éªŒæ•™è®­

1. **ä¸è¦é‡å¤å¤„ç†ä¸šåŠ¡é€»è¾‘**
2. **emitäº‹ä»¶ç”¨äºé€šçŸ¥ï¼Œä¸æ˜¯è®©çˆ¶ç»„ä»¶é‡æ–°å¤„ç†**
3. **ç»„ä»¶åº”è¯¥è‡ªå·±å¤„ç†è‡ªå·±çš„ä¸šåŠ¡**
4. **ä»£ç å®¡æŸ¥è¦æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤å¤„ç†**

---

**ä¿®å¤çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ  
**æµ‹è¯•çŠ¶æ€ï¼š** âœ… å·²é€šè¿‡  
**æ ¹æœ¬åŸå› ï¼š** âœ… å·²è§£å†³  
**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å·²å®Œæˆ
